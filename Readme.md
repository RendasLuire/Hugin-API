
# Hugin API

## üåë The API ‚Äì *The Engine Beneath the Runes*

<p align="left">
  <img src="https://img.shields.io/badge/STATUS-EN%20DESARROLLO-green" />
  <img src="https://img.shields.io/badge/Version-v1.00.0-blue" />
  <img src="https://img.shields.io/badge/Phase-1-pink" />
</p>

## üîçIndex

- [Project Phases](#project-phases)
  - [Phase #1](#phase-1)
- [Version History](#version-history)
- [API Philosophy](#api-philosophy)
- [Diagrams](#diagrams)
- [Data Model](#data-models)
  - [User Model](#user-model)
  - [Account Model](#account-model)
  - [Bank Model](#bank-model)
  - [Movement Model](#movement-model)
  - [Account Type](#account-type-model)
  - [Movement Type](#movement-type-model)
- [EndPoints](#endpoints)
  - [System](#system-routes)
    - [Health Check](#health-check-route)
    - [Initialize](#initialize-route)
  - [User](#users-routes)
    - [Test User Router](#test-user-router)
    - [Register User](#register-user-router)
    - [Find User](#find-user-router)
    - [List all Users](#list-all-users-router)
    - [Update User](#update-user-router)
    - [Delete User](#delete-user-router)
  - [Account](#accounts-routes)
    - [Test Account Router](#test-account-route)
    - [Register Account](#register-account-route)
    - [Find Account](#find-account-route)
    - [List Accounts](#list-all-accounts-route)
    - [Update Account](#update-account-route)
    - [Delete Account](#delete-account-route)
  - [Bank](#bank-routes)
    - [Test Bank Router](#test-bank-router)
    - [Register Bank](#register-bank-router)
    - [Find Bank](#find-bank-router)
    - [List Banks](#list-all-banks-router)
    - [Update Bank](#update-bank-router)
    - [Delete Bank](#delete-bank-router)
  - [Movement](#movement-routes)
    - [Test Movement Router](#test-movement-router)
    - [Register Movement](#register-movement-router)
    - [Find Movement](#find-movement-router)
    - [List Movements](#list-all-movements-router)
    - [Update Movement](#update-movement-router)
    - [Delete Movement](#delete-movement-router)
- [Test](#tests)
- [Tech Stack](#Ô∏ètech-stack)
- [Future Ideas](#future-ideas)

---

## üìêProject Phases

### Phase #1
The objective of the first phase is to build a foundation for registering and tracking expenses and accounts. This will include:

- Initialize the database
- Set up the environment
- Implement authentication (without recovery password)
- CRUD for accounts
- CRUD for users
- CRUD for banks
- CRUD for movements

---

## üìñVersion History

| Version  | Date | Description                                                                       |
| -------- | ---- | --------------------------------------------------------------------------------- |
| 1.0.0    | -    | At this point, the API is able to manage users, accounts, banks and movements.    |

---

## üß†API Philosophy

> *‚ÄúIt hums beneath the surface, unseen yet unyielding‚Ä¶‚Äù*

The API is no mere collection of endpoints.  
It is the will of the system, cast in logic and sealed in shadow.  
It speaks in encrypted tongues, answering only to those who know the rites.

Each request is a whisper.  
Each response, a decree.

Forged in quiet by hands that respect balance,  
it does not forgive malformed offerings ‚Äî  
nor does it tolerate ignorance.

This is the work of Hugin‚Äôs deeper mind,  
a place where runes become action,  
and action bears weight.

**Treat it as sacred. Query with reverence.**

---

## üìäDiagrams

---

## üß±Data Models

### User Model

| name          | description                     | type     | default values  |
| ------------- | ------------------------------- | -------- | --------------- |
| name          |  Full name.                     |  String  |                 |
| email         |  Email address.                 |  String  |                 |
| passwordHash  |  Paasword hashed.               |  String  |                 |
| role          |  Type of user (admin or user).  |  String  | "user"          |

### üí≥Account Model

| name           | description                     | type     | default values  |
| -------------- | ------------------------------- | -------- | --------------- |
| userId         | Foreig key to user.             | ObjectId |                 |
| bankId         | Foreig key to bank.             | ObjectId |                 |
| name           | Name to indentificate.          | String   |                 |
| accountTypeId  | Foreig key to acconunt Type.    | ObjectId |                 |
| balance        | Resume of current balance.      | Number   |  0              |
| nextPay        | Amount to pay closely.          | Number   |  0              |
| cutDay         | Day of cut to calcult next pay. | Number   |  0              |
| payDay         | Day of pay last cut.            | Number   |  0              |
| createdAt      | Date of created account.        | Date     |                 |
| updatedAt      | Date of last update.            | Date     |                 |

### Bank Model

| name      | description                                 | type      | default values  |
| --------- | ------------------------------------------- | --------- | --------------- |
| name      | Name to identificate.                       | String    |                 |
| logoUrl   | Path to logo.                               | String    | ""              |
| state     | State of user (active, archived, deleted).  | String    | "active"        |
| deletedAt | Date of deleted.                            | Date      | null            |
| userId    | Foreig key to user.                         | ObjectId  |                 |

### Movement Model

| name            | description                   | type      | default values  |
| --------------- | ----------------------------- | --------- | --------------- |
| userId          | Foreig key to user.           | ObjectId  |                 |
| accountId       | Foreig key to account.        | ObjectId  |                 |
| movementTypeId  | Foreig key to movement type.  | ObjectId  |                 |
| categoryId      | Foreig key to category.       | ObjectId  |                 |
| description     | Description about movement.   | String    |                 |
| amount          | Movement amount.              | Number    |                 |
| date            | Movement date.                | Date      |                 |

### Account Type Model

| name        | description                           | type    | default values  |
| ----------- | ------------------------------------- | ------- | --------------- |
| name        | Name to identificate.                 | String  |                 |
| key         | String unique.                        | String  |                 |
| description | Explication about usage account type. | String  |                 |
| icon        | String path to icon.                  | String  | null            |
| color       | Color HEX code                        | String  | null            |

### Movement Type Model

| name  | description       | type      | default values  |
| ----- | ----------------- | --------- | --------------- |
| name  | Name to identify. | String    |                 |

---

## üîóEndPoints

### üîßSystem Routes

#### ‚úÖHealth Check Route

- **Descripci√≥n:**
Este endpoint permite verificar si la API est√° en l√≠nea. √ötil para pruebas b√°sicas de disponibilidad.

- **URL:** `/`
- **M√©todo:** `GET`
- **Headers:**

##### **‚úÖRespuesta exitosa `200 OK`**

```JSON
{
  "message": "Express on Vercel with TS."
}  
```

- **‚ùåErrores comunes:**
  - `404` - Ruta no encontrada

#### ‚úÖInitialize Route

- **Descripci√≥n:**

- **URL:** `/`
- **M√©todo:** `GET`
- **Headers:**

##### **‚úÖRespuesta exitosa `200 OK`**

```JSON
{
  
}  
```

- **‚ùåErrores comunes:**
  - `404` - Ruta no encontrada

### Users Routes

#### ‚úÖTest User Router

- **Descripci√≥n:**

- **URL:** `/`
- **M√©todo:** `GET`
- **Headers:**

##### **‚úÖRespuesta exitosa `200 OK`**

```JSON
{
  
}  
```

- **‚ùåErrores comunes:**
  - `404` - Ruta no encontrada

#### ‚úÖRegister User Router

- **Descripci√≥n:**

- **URL:** `/`
- **M√©todo:** `GET`
- **Headers:**

##### **‚úÖRespuesta exitosa `200 OK`**

```JSON
{
  
}  
```

- **‚ùåErrores comunes:**
  - `404` - Ruta no encontrada

#### ‚úÖFind User Router

- **Descripci√≥n:**

- **URL:** `/`
- **M√©todo:** `GET`
- **Headers:**

##### **‚úÖRespuesta exitosa `200 OK`**

```JSON
{
  
}  
```

- **‚ùåErrores comunes:**
  - `404` - Ruta no encontrada

#### ‚úÖList all Users Router

- **Descripci√≥n:**

- **URL:** `/`
- **M√©todo:** `GET`
- **Headers:**

##### **‚úÖRespuesta exitosa `200 OK`**

```JSON
{
  
}  
```

- **‚ùåErrores comunes:**
  - `404` - Ruta no encontrada

#### ‚úÖUpdate User Router

- **Descripci√≥n:**

- **URL:** `/`
- **M√©todo:** `GET`
- **Headers:**

##### **‚úÖRespuesta exitosa `200 OK`**

```JSON
{
  
}  
```

- **‚ùåErrores comunes:**
  - `404` - Ruta no encontrada

#### ‚úÖDelete User Router

- **Descripci√≥n:**

- **URL:** `/`
- **M√©todo:** `GET`
- **Headers:**

##### **‚úÖRespuesta exitosa `200 OK`**

```JSON
{
  
}  
```

- **‚ùåErrores comunes:**
  - `404` - Ruta no encontrada

### üë§Accounts Routes

#### ‚úÖTest Account Route

- **Descripci√≥n:**
Response with a fake user.

- **URL:** `/accounts/test`
- **M√©todo:** `GET`
- **Headers:**

##### **‚úÖRespuesta exitosa `200 OK`**

```JSON
{
  "message": "Accounts Array."
}  
```

- **‚ùåErrores comunes:**
  - `404` - Ruta no encontrada.
  - `401` - Unauthorized access.
  - `500` - Internal Server Error.

#### ‚úÖList all Accounts Route

- **Descripci√≥n:**
Get all accounts relative to current user.

- **URL:** `/accounts`
- **M√©todo:** `GET`
- **Headers:**

##### **‚úÖRespuesta exitosa `200 OK`**

```JSON
{
  "message": "Accounts Array."
}  
```

- **‚ùåErrores comunes:**
  - `404` - Ruta no encontrada.
  - `401` - Unauthorized access.
  - `500` - Internal Server Error.

#### ‚úÖFind Account Route

- **Descripci√≥n:**
Get account.

- **URL:** `/accounts/:id`
- **M√©todo:** `GET`
- **Headers:**

##### **‚úÖRespuesta exitosa `200 OK`**

```JSON
{
  "message": "Account data."
}  
```

- **‚ùåErrores comunes:**
  - `404` - Ruta no encontrada
  - `500` - Internal Server Error

#### ‚úÖRegister Account Route

#### ‚úÖUpdate Account Route

#### ‚úÖDelete Account Route

### Bank Routes

#### ‚úÖTest Bank Router

- **Descripci√≥n:**

- **URL:** `/`
- **M√©todo:** `GET`
- **Headers:**

##### **‚úÖRespuesta exitosa `200 OK`**

```JSON
{
  
}  
```

- **‚ùåErrores comunes:**
  - `404` - Ruta no encontrada

#### ‚úÖRegister Bank Router

- **Descripci√≥n:**

- **URL:** `/`
- **M√©todo:** `GET`
- **Headers:**

##### **‚úÖRespuesta exitosa `200 OK`**

```JSON
{
  
}  
```

- **‚ùåErrores comunes:**
  - `404` - Ruta no encontrada

#### ‚úÖFind Bank Router

- **Descripci√≥n:**

- **URL:** `/`
- **M√©todo:** `GET`
- **Headers:**

##### **‚úÖRespuesta exitosa `200 OK`**

```JSON
{
  
}  
```

- **‚ùåErrores comunes:**
  - `404` - Ruta no encontrada

#### ‚úÖList all Banks Router

- **Descripci√≥n:**

- **URL:** `/`
- **M√©todo:** `GET`
- **Headers:**

##### **‚úÖRespuesta exitosa `200 OK`**

```JSON
{
  
}  
```

- **‚ùåErrores comunes:**
  - `404` - Ruta no encontrada

#### ‚úÖUpdate Bank Router

- **Descripci√≥n:**

- **URL:** `/`
- **M√©todo:** `GET`
- **Headers:**

##### **‚úÖRespuesta exitosa `200 OK`**

```JSON
{
  
}  
```

- **‚ùåErrores comunes:**
  - `404` - Ruta no encontrada

#### ‚úÖDelete Bank Router

- **Descripci√≥n:**

- **URL:** `/`
- **M√©todo:** `GET`
- **Headers:**

##### **‚úÖRespuesta exitosa `200 OK`**

```JSON
{
  
}  
```

- **‚ùåErrores comunes:**
  - `404` - Ruta no encontrada

### Movement Routes

#### ‚úÖTest Movement Router

- **Descripci√≥n:**

- **URL:** `/`
- **M√©todo:** `GET`
- **Headers:**

##### **‚úÖRespuesta exitosa `200 OK`**

```JSON
{
  
}  
```

- **‚ùåErrores comunes:**
  - `404` - Ruta no encontrada

#### ‚úÖRegister Movement Router

- **Descripci√≥n:**

- **URL:** `/`
- **M√©todo:** `GET`
- **Headers:**

##### **‚úÖRespuesta exitosa `200 OK`**

```JSON
{
  
}  
```

- **‚ùåErrores comunes:**
  - `404` - Ruta no encontrada

#### ‚úÖFind Movement Router

- **Descripci√≥n:**

- **URL:** `/`
- **M√©todo:** `GET`
- **Headers:**

##### **‚úÖRespuesta exitosa `200 OK`**

```JSON
{
  
}  
```

- **‚ùåErrores comunes:**
  - `404` - Ruta no encontrada

#### ‚úÖList all Movements Router

- **Descripci√≥n:**

- **URL:** `/`
- **M√©todo:** `GET`
- **Headers:**

##### **‚úÖRespuesta exitosa `200 OK`**

```JSON
{
  
}  
```

- **‚ùåErrores comunes:**
  - `404` - Ruta no encontrada

#### ‚úÖUpdate Movement Router

- **Descripci√≥n:**

- **URL:** `/`
- **M√©todo:** `GET`
- **Headers:**

##### **‚úÖRespuesta exitosa `200 OK`**

```JSON
{
  
}  
```

- **‚ùåErrores comunes:**
  - `404` - Ruta no encontrada

#### ‚úÖDelete Movement Router

- **Descripci√≥n:**

- **URL:** `/`
- **M√©todo:** `GET`
- **Headers:**

##### **‚úÖRespuesta exitosa `200 OK`**

```JSON
{
  
}  
```

- **‚ùåErrores comunes:**
  - `404` - Ruta no encontrada

---

## üß™Tests

### Account Tests

#### Account Model

- ‚úÖ Check valid accounts creation.
- ‚úÖ Validate requeriments `userId`, `name` y `accountTypeId`.
- ‚úÖ Validate info `state`.

#### Account Repository

- ‚úÖ Validate Test Info.
- ‚úÖ Check return accounts.

#### Account Service

- `testAccounts`
  - ‚úÖ Validate Test Response.

- `getAccountsForUser`
  - ‚úÖ Check return accounts.
  - ‚úÖ Validate account is empty.

#### Account Controller

- `testAccountsController`
  - ‚úÖ Validate Test Response.

- `getAccounts`
  - ‚úÖ Check if return code `401 Unauthorized access`.
  - ‚úÖ Check return Accounts List.
  - ‚úÖ Check return code `500 Internal Server Error`.

### Middlewares Tests

#### Auth

- `authMiddleware`
  - ‚úÖ Check if return code `401 Unauthorized access` when request don't have header.
  - ‚úÖ Check if return code `401 Unauthorized access` when token isn¬¥t valid.

#### Config

- `registerMiddlewares`
  - ‚úÖ Check Express
  - ‚úÖ Check Cors
  - ‚úÖ Check Cookie Parser

---

## üõ†Ô∏èTech Stack

---

## üîÆFuture Ideas